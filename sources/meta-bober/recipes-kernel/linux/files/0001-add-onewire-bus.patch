From 454e2fb8c612a4ba6903c5795c4f2d34a3676c45 Mon Sep 17 00:00:00 2001
From: Marcin Bober <oe.patch@oe>
Date: Sun, 16 Jun 2024 16:14:15 +0000
Subject: [PATCH] add onewire bus

---
 .../boot/dts/rockchip/rk3566-radxa-zero-3.dtsi     | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/arch/arm64/boot/dts/rockchip/rk3566-radxa-zero-3.dtsi b/arch/arm64/boot/dts/rockchip/rk3566-radxa-zero-3.dtsi
index 623d5939d194..b5ffbce222e6 100644
--- a/arch/arm64/boot/dts/rockchip/rk3566-radxa-zero-3.dtsi
+++ b/arch/arm64/boot/dts/rockchip/rk3566-radxa-zero-3.dtsi
@@ -87,6 +87,14 @@ vcc_sys: regulator-5v0-vcc-sys {
 		regulator-min-microvolt = <5000000>;
 		regulator-max-microvolt = <5000000>;
 	};
+
+	w1: onewire {
+		pinctrl-names = "default";
+		pinctrl-0 = <&pinctrl_onewire>;
+		compatible = "w1-gpio";
+		gpios = <&gpio1 RK_PA4 GPIO_ACTIVE_HIGH>;
+		status = "okay";
+	};
 };
 
 &combphy1 {
@@ -383,6 +391,12 @@ pmic_int_l: pmic-int-l {
 			rockchip,pins = <0 RK_PA3 RK_FUNC_GPIO &pcfg_pull_up>;
 		};
 	};
+
+	onewire {
+		pinctrl_onewire: onewire-1 {
+			rockchip,pins = <1 RK_PA4 RK_FUNC_GPIO &pcfg_pull_none>;
+		};
+	};
 };
 
 &pmu_io_domains {
-- 
2.34.1

